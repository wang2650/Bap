(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29c231de"],{"0e8f":function(e,t,a){"use strict";a.d(t,"e",function(){return s}),a.d(t,"c",function(){return o}),a.d(t,"f",function(){return i}),a.d(t,"h",function(){return l}),a.d(t,"b",function(){return d}),a.d(t,"d",function(){return u}),a.d(t,"a",function(){return m}),a.d(t,"g",function(){return c});var r=a("0c6d"),n=a("f62d");function s(){return Object(r["a"])({url:"/Api/SystemManage/Department/GetDepartmentListForCurrentUser",method:"get"})}function o(){return Object(r["a"])({url:"/Api/SystemManage/Department/GetDepartmentAndSubDepartmentForCurrentUser",method:"get"})}function i(e){return Object(r["a"])({url:"/Api/SystemManage/Department/InsertDepartment",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/Api/SystemManage/Department/UpdateDepartment",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/Api/SystemManage/Department/DeleteDepartmentByDepartmentId"+n["a"].queryParams(e),method:"get",data:""})}function u(e){return Object(r["a"])({url:"/Api/SystemManage/Department/GetDepartmentList",method:"post",data:e})}function m(e){return Object(r["a"])({url:"/Api/SystemManage/Department/AddUserForDepartment",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/Api/SystemManage/Department/RemoveUserForDepartment",method:"post",data:e})}},"443a":function(e,t,a){"use strict";function r(){return[{value:1,name:"正常",key:"normal"},{value:2,name:"删除",key:"delete"},{value:3,name:"停用",key:"stop"}]}function n(e){var t="正常";switch(e){case 1:t="正常";break;case 2:t="删除";break;case 3:t="停用";break;default:break}return t}a.d(t,"b",function(){return r}),a.d(t,"a",function(){return n})},c24f:function(e,t,a){"use strict";a.d(t,"k",function(){return s}),a.d(t,"h",function(){return o}),a.d(t,"c",function(){return i}),a.d(t,"d",function(){return l}),a.d(t,"g",function(){return d}),a.d(t,"b",function(){return u}),a.d(t,"a",function(){return m}),a.d(t,"i",function(){return c}),a.d(t,"j",function(){return p}),a.d(t,"e",function(){return f}),a.d(t,"f",function(){return g});var r=a("0c6d"),n=a("f62d");function s(e){return Object(r["a"])({url:"/api/SystemManage/User/Login",method:"post",data:e,headers:{aaaaaaa:"bb"}})}function o(e){return Object(r["a"])({url:"/api/SystemManage/User/ResetPassord",method:"post",data:e})}function i(){return Object(r["a"])({url:"/api/SystemManage/User/GetCurrentUserInfo",method:"get"})}function l(e){return Object(r["a"])({url:"/api/SystemManage/User/GetUserList",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/api/SystemManage/User/InsertUser",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/api/SystemManage/User/DeleteUser"+n["a"].queryParams(e),method:"get"})}function m(e){return Object(r["a"])({url:"/api/SystemManage/User/batchRemoveUser",method:"get",data:e})}function c(e){return Object(r["a"])({url:"/api/SystemManage/User/UpdateMyselfInfo",method:"post",data:e})}function p(e){return Object(r["a"])({url:"/api/SystemManage/User/UpdateUsers",method:"post",data:e})}function f(e){return Object(r["a"])({url:"/api/SystemManage/User/GetUsersRefDepartment",method:"post",data:e})}function g(e){return Object(r["a"])({url:"/api/SystemManage/User/GetUsersRefRole",method:"post",data:e})}},f71d:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.filters},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"部门"}},[a("el-cascader",{attrs:{"expand-trigger":"hover","show-all-levels":!1,"change-on-select":"",options:e.departmentoptions},on:{change:e.cascaderChange},model:{value:e.seldepartment,callback:function(t){e.seldepartment=t},expression:"seldepartment"}})],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"角色名"},model:{value:e.filters.name,callback:function(t){e.$set(e.filters,"name",t)},expression:"filters.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getroles}},[e._v("查询")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.roles,"highlight-current-row":""},on:{"selection-change":e.selsChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Id",label:"角色Id",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"RoleName",label:"角色名",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Description",label:"说明",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"AddDateTime",label:"创建时间",width:"120",formatter:e.formatCreateTime}}),e._v(" "),a("el-table-column",{attrs:{prop:"RsState",label:"状态",width:"100",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:1===t.row.RsState?"success":"danger","disable-transitions":""}},[e._v(e._s(e.getstatetext(t.row.RsState)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){return e.handleMenu(t.$index,t.row)}}},[e._v("设置权限")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(a){return e.diaplaySetUpUser(t.$index,t.row)}}},[e._v("设置员工")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.handleDel(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":50,total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:e.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}},model:{value:e.editFormVisible,callback:function(t){e.editFormVisible=t},expression:"editFormVisible"}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"80px",rules:e.editFormRules}},[a("el-form-item",{attrs:{label:"角色名",prop:"RoleName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.RoleName,callback:function(t){e.$set(e.editForm,"RoleName",t)},expression:"editForm.RoleName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"说明",prop:"Description"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.Description,callback:function(t){e.$set(e.editForm,"Description",t)},expression:"editForm.Description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"RsState"}},[a("el-select",{attrs:{placeholder:"请选择角色状态"},model:{value:e.editForm.RsState,callback:function(t){e.$set(e.editForm,"RsState",t)},expression:"editForm.RsState"}},e._l(e.statelt,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.editLoading},nativeOn:{click:function(t){return e.editSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增",visible:e.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t}},model:{value:e.addFormVisible,callback:function(t){e.addFormVisible=t},expression:"addFormVisible"}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[a("el-form-item",{attrs:{label:"角色名",prop:"RoleName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.RoleName,callback:function(t){e.$set(e.addForm,"RoleName",t)},expression:"addForm.RoleName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"说明",prop:"Description"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.Description,callback:function(t){e.$set(e.addForm,"Description",t)},expression:"addForm.Description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"RsState"}},[a("el-select",{attrs:{placeholder:"请选择角色状态"},model:{value:e.addForm.RsState,callback:function(t){e.$set(e.addForm,"RsState",t)},expression:"addForm.RsState"}},e._l(e.statelt,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:e.userdialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.userdialogVisible=t}},model:{value:e.userdialogVisible,callback:function(t){e.userdialogVisible=t},expression:"userdialogVisible"}},[a("el-form",{attrs:{inline:!0,model:e.userForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.userForm.name,callback:function(t){e.$set(e.userForm,"name",t)},expression:"userForm.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getuserlist}},[e._v("查询")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userlist,"highlight-current-row":""},on:{"selection-change":e.handleMulUser}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ID",label:"用户Id",width:"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"UserName",label:"用户名",width:"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"NickName",label:"昵称",width:"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"DepartmentId",label:"是否在角色内",width:"200",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(0===t.row.RoleId?"否":"是"))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){return e.addOneUserToRole(t.$index,t.row)}}},[e._v("加入")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.romveOneUserToRole(t.$index,t.row)}}},[e._v("移除")])]}}])})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{size:"small"},on:{click:e.batchAddOneUserToRole}},[e._v("批量添加")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:e.batchRemoveOneUserToRole}},[e._v("批量移除")])],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":e.pagesize,total:e.userlisttotal},on:{"current-change":e.handleUserListChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"设置权限",visible:e.menuFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.menuFormVisible=t}},model:{value:e.menuFormVisible,callback:function(t){e.menuFormVisible=t},expression:"menuFormVisible"}},[a("el-form",{ref:"menuForm",attrs:{model:e.menuForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"权限"}},[a("el-tree",{ref:"tree",attrs:{data:e.menuForm.allnodes,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.menuForm.selectednodes,props:e.defaultProps}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.menuFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.menuLoading},nativeOn:{click:function(t){return e.menusubmit(t)}}},[e._v("提交")])],1)],1)],1)},n=[],s=(a("7f7f"),a("c1df")),o=a.n(s),i=a("0c6d"),l=a("f62d");function d(e){return Object(i["a"])({url:"/api/SystemManage/Role/GetRoleList",method:"post",data:e})}function u(e){return Object(i["a"])({url:"/api/SystemManage/Role/InsertRole",method:"post",data:e})}function m(e){return Object(i["a"])({url:"/api/SystemManage/Role/DeleteRoleByRoleId"+l["a"].queryParams(e),method:"get"})}function c(e){return Object(i["a"])({url:"/api/SystemManage/Role/UpdateRole",method:"post",data:e})}function p(e){return Object(i["a"])({url:"/api/SystemManage/Role/RemoveUserFromRole",method:"post",data:e})}function f(e){return Object(i["a"])({url:"/api/SystemManage/Role/AddUserForRole",method:"post",data:e})}var g=a("0e8f"),h=a("443a"),b=a("1f27"),v=a("c24f"),y={data:function(){return{filters:{name:""},statelt:{},departmentoptions:[],seldepartment:[],departmentid:-1,roles:[],total:0,page:1,pagesize:10,listLoading:!1,sels:[],addDialogFormVisible:!1,editFormVisible:!1,editLoading:!1,editFormRules:{RoleName:[{required:!0,message:"请输入角色名",trigger:"blur"}]},editForm:{Id:0,RoleName:"",Description:"",RsState:1},addFormVisible:!1,addLoading:!1,addFormRules:{RoleName:[{required:!0,message:"请输入登录名",trigger:"blur"}]},addForm:{RoleName:"",Description:"",RsState:"",DepartmentId:-1},modifyRoleId:0,menuLoading:!1,menuFormVisible:!1,menuForm:{allnodes:[],selectednodes:[]},defaultProps:{children:"children",label:"label"},userdialogVisible:!1,userForm:{name:"",RoleId:0},userlist:[],mulselectedusers:[],userlisttotal:0}},methods:{formatCreateTime:function(e,t){var a=e.AddDateTime;return a?o()(a).format("YYYY-MM-DD HH-mm"):""},getdepartmentlist:function(){var e=this,t={Page:{PageIndex:this.page,PageSize:this.pagesize}};this.listLoading=!0,Object(g["c"])(t).then(function(t){e.listLoading=!1,0===t.Code?(e.departmentoptions=t.Data,e.departmentoptions.length>0&&(e.departmentid=e.departmentoptions[0].value,e.seldepartment=[e.departmentoptions[0].value],e.getroles())):message({message:"获取部门失败",type:"warning"})})},cascaderChange:function(e){this.departmentid=e[e.length-1],this.getroles()},getstatetext:function(e){return Object(h["a"])(e)},handleCurrentChange:function(e){this.page=e,this.getroles()},getroles:function(){var e=this,t={Page:{PageIndex:this.page,PageSize:this.pagesize},DepartmentId:this.departmentid||-1,RoleName:this.filters.name};this.listLoading=!0,d(t).then(function(t){e.listLoading=!1,0===t.Code?(e.total=t.Data.Total,e.roles=t.Data.Result):message({message:"获取列表失败",type:"warning"})})},handleDel:function(e,t){var a=this;this.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(function(){a.NProgress.start();var e={Id:t.Id};m(e).then(function(e){a.NProgress.done(),0===e.Code?a.$message({message:"删除成功",type:"success"}):a.$message({message:e.Errors.join("  "),type:"error"}),a.getroles()})}).catch(function(){})},handleMenu:function(e,t){var a=this;this.modifyRoleId=t.Id;var r={roleId:t.Id,departmentId:this.departmentid};Object(b["b"])(r).then(function(e){a.NProgress.done(),0===e.Code?(a.menuForm.allnodes=e.Data.AllNodes,a.menuForm.selectednodes=e.Data.SelectedNodes,a.menuFormVisible=!0):a.$message({message:e.Errors.join("  "),type:"error"})}).catch(function(){a.$message({message:"获取权限失败",type:"error"})})},handleEdit:function(e,t){this.statelt=Object(h["b"])(),this.editFormVisible=!0,this.editForm=Object.assign({},t)},handleAdd:function(){this.statelt=Object(h["b"])(),this.addFormVisible=!0,this.addForm={id:0,RoleName:"",Description:"",RsState:1,DepartmentId:this.departmentid}},editSubmit:function(){var e=this;this.$refs.editForm.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){e.NProgress.start();var t=Object.assign({},e.editForm);c(t).then(function(t){e.NProgress.done(),0===t.Code?(e.editFormVisible=!1,e.$message({message:"操作成功",type:"success"}),e.$refs["editForm"].resetFields(),e.getroles()):e.$message({message:t.Errors.join("  "),type:"error"})})})})},addSubmit:function(){var e=this;this.$refs.addForm.validate(function(t){if(!t)return!1;e.$confirm("确认提交吗？","提示",{}).then(function(){e.addLoading=!0;var t=Object.assign({},e.addForm);u(t).then(function(t){e.addLoading=!1,0===t.Code?(e.$message({message:"操作成功",type:"success"}),e.$refs["addForm"].resetFields(),e.addFormVisible=!1,e.getroles()):e.$message({message:t.Errors.join("  "),type:"error"})}).catch(function(t){e.addLoading=!1,console.log(t)})})})},selsChange:function(e){this.sels=e},menusubmit:function(){var e=this;this.$confirm("确认提交吗？","提示",{}).then(function(){e.NProgress.start();var t=e.$refs.tree.getCheckedKeys().concat(e.$refs.tree.getHalfCheckedKeys()),a={RoleId:e.modifyRoleId,MenuIds:t};Object(b["c"])(a).then(function(t){e.NProgress.done(),0===t.Code?(e.menuFormVisible=!1,e.$message({message:"操作成功",type:"success"})):e.$message({message:t.Errors.join("  "),type:"error"})})})},getuserlist:function(){var e=this,t={Page:{PageIndex:this.page,PageSize:this.pagesize},Name:this.userForm.name,RoleId:this.userForm.RoleId};Object(v["f"])(t).then(function(t){0===t.Code?(e.userlist=t.Data.Result,e.userlisttotal=t.Data.Total):message({message:"获取角色中用户失败",type:"warning"})})},handleMulUser:function(e){this.mulselectedusers=e},handleUserListChange:function(e){this.page=e,this.getuserlist()},diaplaySetUpUser:function(e,t){this.userdialogVisible=!0,this.userForm.RoleId=t.Id,this.userForm.name="",this.getuserlist()},addUserToRole:function(e){var t=this;this.$confirm("确认添加该用户吗?","提示",{type:"warning"}).then(function(){t.NProgress.start();var a={UserIds:e,RoleId:t.userForm.RoleId};f(a).then(function(e){t.NProgress.done(),0===e.Code?t.$message({message:"添加成功",type:"success"}):t.$message({message:e.Errors.join("  "),type:"error"}),t.getuserlist()})}).catch(function(){})},removeUserFromRole:function(e){var t=this;this.$confirm("确认移除该用户吗?","提示",{type:"warning"}).then(function(){t.NProgress.start();var a={UserIds:e,RoleId:t.userForm.RoleId};p(a).then(function(e){t.NProgress.done(),0===e.Code?t.$message({message:"删除成功",type:"success"}):t.$message({message:e.Errors.join("  "),type:"error"}),t.getuserlist()})}).catch(function(){})},romveOneUserToRole:function(e,t){var a=[t.ID];this.removeUserFromRole(a)},addOneUserToRole:function(e,t){var a=[t.ID];this.addUserToRole(a)},batchRemoveOneUserToRole:function(){if(null==this.mulselectedusers||0===this.mulselectedusers.length)this.$message({message:"请先选择用户",type:"warn"});else{var e=a("0063"),t=e.from(this.mulselectedusers).select(function(e){return e.ID}).toArray();this.mulselectedusers=[],this.romveOneUserToRole(t)}},batchAddOneUserToRole:function(){if(null==this.mulselectedusers||0===this.mulselectedusers.length)this.$message({message:"请先选择用户",type:"warn"});else{var e=a("0063"),t=e.from(this.mulselectedusers).select(function(e){return e.ID}).toArray();this.mulselectedusers=[],this.addUserToRole(t)}}},mounted:function(){this.getdepartmentlist()}},F=y,R=a("2877"),_=Object(R["a"])(F,r,n,!1,null,null,null);t["default"]=_.exports}}]);